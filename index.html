<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Log Streaming Pipeline - Clean Visualization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #F8FAFC; /* Clean White/Grey background */
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Inter', -apple-system, sans-serif;
        }
        #canvas-container {
            width: 95%;
            max-width: 1400px;
            aspect-ratio: 21 / 9;
            position: relative;
            background: #FFFFFF;
            border-radius: 24px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.05);
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.05);
        }
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>

    <div id="canvas-container">
        <canvas id="pipelineCanvas" width="1400" height="600"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('pipelineCanvas');
        const ctx = canvas.getContext('2d');

        const width = canvas.width;
        const height = canvas.height;
        const centerY = height / 2;

        const nodes = [
            { name: "AWS Lambda", x: 200, color: "#FF9900", icon: drawLambda },
            { name: "CloudWatch", x: 450, color: "#E7157B", icon: drawCloudWatch },
            { name: "Kinesis Firehose", x: 700, color: "#8C4FFF", icon: drawFirehose },
            { name: "Amazon S3", x: 950, color: "#3F8624", icon: drawS3 },
            { name: "Amazon Athena", x: 1200, color: "#1292B4", icon: drawAthena }
        ];

        let particles = [];
        let frameCount = 0;
        let folderPulse = 0;

        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.active = true;
                this.type = 'GZ';
            }

            update() {
                let speed = 3.5;
                if (this.x > nodes[1].x && this.x < nodes[2].x) {
                    speed = 1.2;
                } else if (this.x >= nodes[2].x && this.x < nodes[3].x) {
                    speed = 6.5;
                    this.type = 'JSON';
                }

                this.x += speed;

                if (this.x >= nodes[3].x) {
                    this.active = false;
                    folderPulse = 1.0;
                }
            }

            draw(ctx) {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.type === 'GZ' ? 4 : 5, 0, Math.PI * 2);
                ctx.fillStyle = this.type === 'GZ' ? '#E11D48' : '#0EA5E9';
                ctx.fill();
            }
        }

        function drawPath() {
            ctx.beginPath();
            ctx.moveTo(nodes[0].x, centerY);
            ctx.lineTo(nodes[3].x, centerY);
            ctx.strokeStyle = '#E2E8F0';
            ctx.lineWidth = 14;
            ctx.lineCap = 'round';
            ctx.stroke();
        }

        function drawIconBase(x, y, color) {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.roundRect(x - 40, y - 40, 80, 80, 20);
            ctx.fill();
        }

        function drawLambda(x, y) {
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(x - 8, y - 10); ctx.lineTo(x + 8, y + 14);
            ctx.moveTo(x, y + 4); ctx.lineTo(x - 8, y + 14);
            ctx.stroke();
        }

        function drawCloudWatch(x, y) {
            ctx.fillStyle = '#FFFFFF';
            ctx.beginPath();
            ctx.arc(x - 8, y + 2, 8, 0, Math.PI*2);
            ctx.arc(x + 4, y - 4, 10, 0, Math.PI*2);
            ctx.arc(x + 12, y + 6, 6, 0, Math.PI*2);
            ctx.rect(x - 8, y - 2, 20, 14);
            ctx.fill();
        }

        function drawFirehose(x, y) {
            ctx.fillStyle = '#FFFFFF';
            ctx.beginPath();
            ctx.moveTo(x - 14, y - 10); ctx.lineTo(x + 14, y - 10);
            ctx.lineTo(x + 6, y + 12); ctx.lineTo(x - 6, y + 12);
            ctx.fill();
            
            ctx.font = 'bold 10px sans-serif';
            ctx.fillStyle = '#475569';
            ctx.textAlign = 'center';
            ctx.fillText("UNZIP", x, y - 45);
            ctx.fillText("+ \\n", x, y + 55);
        }

        function drawS3(x, y) {
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.ellipse(x, y - 10, 14, 5, 0, 0, Math.PI * 2);
            ctx.moveTo(x - 14, y - 10); ctx.lineTo(x - 14, y + 10);
            ctx.moveTo(x + 14, y - 10); ctx.lineTo(x + 14, y + 10);
            ctx.ellipse(x, y + 10, 14, 5, 0, 0, Math.PI);
            ctx.stroke();
        }

        function drawAthena(x, y) {
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(x - 12, y - 8); ctx.lineTo(x + 12, y - 8);
            ctx.moveTo(x - 12, y); ctx.lineTo(x + 12, y);
            ctx.moveTo(x - 12, y + 8); ctx.lineTo(x + 12, y + 8);
            ctx.stroke();
        }

        function drawFolders(x, y) {
            const drawF = (fx, fy, alpha) => {
                ctx.fillStyle = `rgba(234, 179, 8, ${alpha})`;
                ctx.beginPath();
                ctx.roundRect(fx - 12, fy - 6, 24, 16, 2);
                ctx.fill();
            };
            drawF(x, y + 25, 0.4);
            drawF(x, y + 15, 0.7);
            drawF(x, y + 5, 1.0);
        }

        function animate(time) {
            ctx.clearRect(0, 0, width, height);
            drawPath();

            if (frameCount % 12 === 0) particles.push(new Particle(nodes[0].x, centerY));

            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].update();
                if (!particles[i].active) particles.splice(i, 1);
                else particles[i].draw(ctx);
            }

            drawFolders(nodes[3].x, centerY);

            nodes.forEach(node => {
                drawIconBase(node.x, centerY, node.color);
                node.icon(node.x, centerY);
                ctx.fillStyle = '#475569';
                ctx.font = '600 14px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(node.name, node.x, centerY + 70);
            });

            // Scanner
            const magX = nodes[3].x + Math.sin(time * 0.002) * 40;
            const magY = centerY - 80;
            ctx.beginPath();
            ctx.arc(magX, magY, 15, 0, Math.PI*2);
            ctx.strokeStyle = '#1292B4';
            ctx.lineWidth = 4;
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(magX + 10, magY + 10); ctx.lineTo(magX + 18, magY + 18);
            ctx.stroke();

            frameCount++;
            requestAnimationFrame(animate);
        }

        requestAnimationFrame(animate);
    </script>
</body>
</html>